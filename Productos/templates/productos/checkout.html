{% extends 'users/base.html' %}
{% load static %}
{% load humanize %}

{% block title %}
    <title>CheckOut - Chequea Y Pide</title>
{% endblock %}

{% block styles %}
    <link rel="stylesheet" href="{% static 'productos/css/checkout.css' %}">
    <link rel="stylesheet" href="{% static 'productos/css/cart.css' %}">
{% endblock %}

{% block container %}
    <div class="container">
        <nav aria-label="breadcrumb">
            <ol class="breadcrumb">
                <li class="breadcrumb-item"><a href="{% url 'home' %}">Inicio</a></li>
                <li class="breadcrumb-item"><a href="{% url 'productos' %}">Productos</a></li>
                <li class="breadcrumb-item"><a href="{% url 'cart' %}">Carrito</a></li>
                <li class="breadcrumb-item active">CheckOut - Datos de Envío</li>
            </ol>
        </nav>
    </div>
    <div class="container">
        {% block form_data %}
            <div class="data">
                <p>
                    <a class="text-decoration-none text-dark fs-1 w-100 d-inline-block" data-bs-toggle="collapse" href="#collapseExample" role="button" aria-expanded="true" aria-controls="collapseExample">
                        <span class="number">1</span> Datos de Envío
                    </a>
                </p>
                <div class="collapse show" id="collapseExample">
                    <div class="card card-body">
                        <form action="{% url 'checkout' %}" method="post" enctype="multipart/form-data">
                            {% csrf_token %}
                            <div class="mb-3">
                                <label for="formGroupExampleInput" class="form-label">Nombre</label>
                                <input type="text" class="form-control" id="formGroupExampleInput" placeholder="John" name="name" required>
                            </div>

                            <div class="mb-3">
                                <label for="formGroupExampleInput" class="form-label">Apellido</label>
                                <input type="text" class="form-control" id="formGroupExampleInput" placeholder="Doe", name="last_name" required>
                            </div>

                            <div class="mb-3">
                                <label for="formGroupExampleInput" class="form-label">Correo electrónico</label>
                                <input type="email" class="form-control" id="formGroupExampleInput" placeholder="JohnDoe123@gmail.com" name="email" required>
                            </div>

                            <div class="mb-3">
                                <label for="formGroupExampleInput" class="form-label">Teléfono</label>
                                <input type="number" class="form-control" id="formGroupExampleInput" placeholder="0000 0000000" name="phone" required>
                            </div>

                            <div class="mb-3">
                                <label for="formGroupExampleInput" class="form-label">Dirección</label>
                                <input type="text" class="form-control" id="formGroupExampleInput" placeholder="Urbanización ** Calle 00 con Avenida 00" name="address" required>
                            </div>

                            <div class="mb-3">
                                <label for="formGroupExampleInput" class="form-label">Ciudad</label>
                                <input type="text" class="form-control" id="formGroupExampleInput" placeholder="Lara" name="city" required>
                            </div>

                            <div class="mb-3">
                                <label for="formGroupExampleInput" class="form-label">País</label>
                                <input type="text" class="form-control" id="formGroupExampleInput" placeholder="Venezuela" name="country" required>
                            </div>

                            <div class="mb-3">
                                <label for="formGroupExampleInput" class="form-label">Documento de Identidad</label>
                                <input type="number" class="form-control" id="formGroupExampleInput" placeholder="" name="dni" required>
                            </div>

                            <div class="actions d-flex justify-content-between gap-3">
                                <button class="btn btn-outline-danger rounded-0" type="reset">Limpiar</button>
                                <button class="btn btn-primary rounded-0" type="submit">Siguiente</button>
                            </div>

                        </form>
                    </div>
                </div>
            </div>
        {% endblock %}

        <div class="total_cart bg-white p-5" style="position: sticky; top: 5rem">
            <h3 class="title fw-bold text-center">Tu Orden</h3>
            <table class="table table-hover">
                <thead>
                    <tr>
                        <th scope="col"></th>
                        <th scope="col"></th>
                        <th scope="col"></th>
                    </tr>
                </thead>

                <tbody>
                    {% for producto in cart_prd %}
                        <tr>
                            <th scope="row" class="title"><figure class="m-0 align-middle img_product_cart" style="background-image: url({{ producto.imagen }}); width: 3rem; height: 3rem"></figure></th>
                            <th scope="row" class="title align-middle">{{ producto.nombre }}</th>
                            <td class="text-muted number align-middle">{{ producto.cantidad }} x $ {{ producto.precio }} = $ {{ producto.monto_total }}</td>
                        </tr>
                    {% endfor %}

                    <tr>
                        <td></td>
                        <th scope="row" class="title">Subtotal</th>
                        <td class="center-y number">$ {{ cart.get_subtotal }}</td>
                    </tr>
                    <tr>
                        <td></td>
                        <th scope="row" class="title">I.V.A.</th>
                        <td class="center-y number">$ {{ cart.get_iva }}</td>
                    </tr>
                    <tr>
                        <td></td>
                        <th scope="row" class="title">Total</th>
                        <td class="center-y number">$ {{ cart.get_total_iva }}</td>
                    </tr>
                </tbody>
            </table>
        </div>
    </div>
{% endblock %}
